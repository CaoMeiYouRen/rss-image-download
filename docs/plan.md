# 项目核心功能分析 (Node.js 纯净版 - 增强型)

## 1. 核心功能概述
本项目是一个纯粹的 Node.js 自动化脚本服务，负责监控 RSS 订阅源、下载图片、打包资源并备份至百度网盘。完全通过 CLI 运行，支持定时任务与单次执行。

## 2. 增强逻辑与优化

### 2.1 执行模式优化
- **双模运行**：支持 Cron 常驻运行与零 Cron 一次性运行。
- **冷启动支持**：启动时可配置立即执行。

### 2.2 存储与去重 (SQLite)
- **ACID 持久化**：使用 better-sqlite3 记录下载/上传历史，支持任务中断恢复。

### 2.3 智能上传与搜索
- **搜索关键词优化**：处理 BaiduPCS-Go 的 22 字符限制（错误码 31023），自动截断关键词进行检索。
- **上传重试机制**：增加 3 次上传重试逻辑，提升在网络不稳定环境下的成功率。
- **云端去重**：上传前查表 + 云端检索，双重保证不重复上传。

### 2.4 多通道推送通知
- **Push-all-in-one 集成**：通过 https://github.com/CaoMeiYouRen/push-all-in-one 支持钉钉、企业微信、Server酱等多种通知通道。
- **关键节点上报**：下载完成、备份成功、任务失败等关键时刻发送通知。

---

# 实现步骤规划

## 1. 核心模块
- src/core/database.ts: SQLite 状态管理。
- src/utils/baidu.ts: 封装 BaiduPCS-Go（含 22 字符限制处理逻辑其实在调用层 index.ts 中）。
- src/utils/push.ts: 推送服务封装。
- src/index.ts: 核心流程控、Cron 调度、重试逻辑及通知触发。
